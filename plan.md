# План работ

## Задача: миграция загрузки тикеров CEX-коннекторов на конфигурацию YAML *(статус: выполнено)*

1. **Схема конфигурации**
   - Добавить в `configs/screener-core.yaml` описание бирж с полями `name`, `symbols`, `symbols_file`.
   - Сохранить обратную совместимость через глобальный список `exchanges` и общий JSON.

2. **Парсинг конфигурации**
   - Расширить `internal/config/config.go`, чтобы читать новый блок бирж и выдавать структуру `ExchangeConfig`.
   - Обработать приоритеты: сначала `symbols`, потом `symbols_file`, дальше fallback на общий JSON.

3. **Использование в сервисах**
   - Обновить `cmd/screener-core/main.go`: формировать набор тикеров для каждой биржи на основе конфигурации.
   - Обновить `cmd/api-gateway/main.go`: использовать те же правила загрузки тикеров. *(историческая задача, сервис позже удалён)*
   - Вести подробный лог выбранных источников.

4. **Чистка прямых ссылок**
   - Найти оставшиеся обращения к `Temp/all_contracts_merged_reformatted.json` в core/gateway и заменить на новый механизм или отметить как утилитарные.

5. **Проверка**
   - Выполнить `go build ./cmd/screener-core` и `go build ./cmd/api-gateway`. *(актуально на этапе миграции; после удаления API Gateway не требуется)*
   - Зафиксировать результат и необходимые дальнейшие шаги. *(выполнено)*

## Задача: вывод из эксплуатации API Gateway

1. **Анализ зависимости** *(выполнено)*
   - Собрать список файлов и пакетов, которые использует `cmd/api-gateway`.
   - Проверить, кто импортирует общие модули из `internal` и `configs`, чтобы не удалить нужное core.

2. **Определение границ удаления** *(выполнено)*
   - Решить, какие части конфигурации остаются общими, а какие специфичны для API Gateway.
   - Зафиксировать, какие бинарники, docker-артефакты и скрипты больше не нужны.

3. **Пошаговое удаление**
   - Удалить директорию `cmd/api-gateway` и связанные Dockerfile/скрипты. *(выполнено)*
   - Очистить конфиги (`configs/api-gateway.yaml`, `plan.md`, README) от упоминаний сервиса.
   - Проверить зависимости в `go.mod`, удалив неиспользуемые пакеты.

4. **Валидация**
   - Запустить `go build ./cmd/screener-core` для проверки разрыва зависимостей.
   - Обновить план и документацию по итогам.

## Задача: актуализация архитектурной блок-схемы

1. **Новый контекст**
   - Зафиксировать, что API Gateway выведен из эксплуатации.
   - Отразить переход на YAML-конфигурацию в качестве источника списка токенов.

2. **Обновление диаграммы**
   - Переписать существующую блок-схему в формате Mermaid с учётом текущей архитектуры.
   - Визуализировать поток данных: конфиг → загрузка символов → коннекторы → Redis → внешний десктопный клиент.

3. **Документация**
   - Разместить диаграмму в актуальном разделе документации и убедиться, что текст вокруг не ссылается на устаревшие компоненты.
