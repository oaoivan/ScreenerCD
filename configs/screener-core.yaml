exchange: "bybit" # legacy single exchange, kept for backward compatibility
exchanges: ["gate", "bybit", "bitget", "okx"]
symbol: "BTC-USDT"
api_key: ""
secret: ""

default_symbols_file: "ticker_source/geckoterminal_pools.json"

exchange_configs:
  - name: "gate"
    symbols_file: "ticker_source/geckoterminal_pools.json"
  - name: "bybit"
    symbols_file: "ticker_source/geckoterminal_pools.json"
  - name: "bitget"
    symbols_file: "ticker_source/geckoterminal_pools.json"
  - name: "okx"
    symbols_file: "ticker_source/geckoterminal_pools.json"

redis: 
  host: "localhost"
  port: 6379

logging: 
  level: "info"
  file: "logs/screener.log"

# DEX connectors configuration
dex_configs:
  - name: "uniswap_v2"
    network: "ethereum"
    ws_url: "wss://eth-mainnet.g.alchemy.com/v2/ebe6XDskLuIVCgDO1NlB-"
    http_url: "https://eth-mainnet.g.alchemy.com/v2/ebe6XDskLuIVCgDO1NlB-"
    subscribe_batch: 120
    ping_interval: 25
    pools_file: "ticker_source/geckoterminal_pools.json"
    pools:
      - address: "0xB4e16d0168e52d35CaCD2c6185b44281Ec28C9Dc"
        pair_name: "USDC/WETH"
        token0_symbol: "USDC"
        token1_symbol: "WETH"
        token0_address: "0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48"
        token1_address: "0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2"
        token0_decimals: 6
        token1_decimals: 18
        base_is_token0: false
        canonical_pair: "WETHUSDC"
      - address: "0x0d4a11d5EEaaC28EC3F61d100daf4d40471f1852"
        pair_name: "WETH/USDT"
        token0_symbol: "WETH"
        token1_symbol: "USDT"
        token0_address: "0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2"
        token1_address: "0xdAC17F958D2ee523a2206206994597C13D831ec7"
        token0_decimals: 18
        token1_decimals: 6
        base_is_token0: true
        canonical_pair: "WETHUSDT"

  - name: "uniswap_v3"
    network: "ethereum"
    ws_url: "wss://eth-mainnet.g.alchemy.com/v2/ebe6XDskLuIVCgDO1NlB-"
    http_url: "https://eth-mainnet.g.alchemy.com/v2/ebe6XDskLuIVCgDO1NlB-"
    subscribe_batch: 150
    ping_interval: 25
    max_meta_workers: 8
    swap_only: true
    log_all_events: false
    stop_on_ack_error: false
    pools_source:
      file: "Temp/geckoterminal_pools.json"
      env: "GECKO_POOLS_JSON"
      gecko_dex: "uniswap_v3"
      gecko_network: "ethereum"

# Performance tuning
data_channel_buffer: 8192         # 8k–32k в зависимости от нагрузки
redis_workers: 8                  # 8–16 воркеров
redis_pipeline_size: 300          # батч пайплайна 200–500
subscribe_batch_size: 100         # подписываться пачками по N символов
subscribe_batch_pause_ms: 150     # пауза между пачками, мс
metrics_period_sec: 5             # период агрегированных логов

# Reference pools for deriving base-asset USD prices
reference_pools:
  - chain: "ethereum"
    dex: "uniswap_v3"
    base_token:
      symbol: "WETH"
      address: "0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2"
    quote_token:
      symbol: "USDC"
      address: "0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"
    pool_address: "0x88e6A0c2dDD26FEEb64F039a2c41296FcB3f5640"
    fee_tier: 500

  - chain: "bsc"
    dex: "pancakeswap_v2"
    base_token:
      symbol: "WBNB"
      address: "0xBB4CdB9CBd36B01bD1cBaEBF2De08d9173bc095c"
    quote_token:
      symbol: "USDT"
      address: "0x55d398326f99059fF775485246999027B3197955"
    pool_address: "0x16b9a82891338f9bA80E2D6970FddA79D1eb0daE"

# Bitget-specific tuning (WS limits: 10 msgs/s, 240 subs/hour, <=1000 streams)
bitget_subscribe_batch_size: 30   # сколько инстр. в одном сообщении подписки
bitget_subscribe_pause_ms: 700    # пауза между батчами, мс
bitget_ping_interval_sec: 25      # интервал ping
